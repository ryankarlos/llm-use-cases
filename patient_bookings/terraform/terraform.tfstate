{
  "version": 4,
  "terraform_version": "1.12.2",
  "serial": 84,
  "lineage": "58345e2a-0585-9ed9-51bf-676e11e8b95f",
  "outputs": {
    "agent_alias_id": {
      "value": "QGFY7425NI",
      "type": "string"
    },
    "agent_id": {
      "value": "P7QFL8LKUN",
      "type": "string"
    },
    "booking_flow_arn": {
      "value": "arn:aws:bedrock:us-east-1:376337229415:flow/6MJTEBZ19S",
      "type": "string"
    },
    "booking_flow_id": {
      "value": "6MJTEBZ19S",
      "type": "string"
    },
    "data_source_id": {
      "value": "5MD90JCUDG",
      "type": "string"
    },
    "demo_bucket": {
      "value": "nhs-booking-demo-demo-376337229415",
      "type": "string"
    },
    "env_vars": {
      "value": "export AWS_REGION=us-east-1\nexport BEDROCK_AGENT_ID=P7QFL8LKUN\nexport BEDROCK_AGENT_ALIAS_ID=QGFY7425NI\nexport AUDIO_BUCKET=nhs-booking-demo-demo-376337229415\n",
      "type": "string"
    },
    "kb_id": {
      "value": "BNGLROUXOJ",
      "type": "string"
    },
    "kb_source_bucket": {
      "value": "nhs-booking-demo-kb-source-376337229415",
      "type": "string"
    },
    "lambda_function": {
      "value": "nhs-booking-demo-actions",
      "type": "string"
    },
    "s3_vectors_bucket": {
      "value": "nhs-booking-demo-vectors",
      "type": "string"
    },
    "s3_vectors_index": {
      "value": "arn:aws:s3vectors:us-east-1:376337229415:bucket/nhs-booking-demo-vectors/index/nhs-booking-demo-index",
      "type": "string"
    },
    "supervisor_agent_id": {
      "value": "R5CKKTHOFB",
      "type": "string"
    },
    "supervisor_alias_id": {
      "value": "CWU2HM8ITH",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "archive_file",
      "name": "lambda",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "exclude_symlink_directories": null,
            "excludes": null,
            "id": "2cab8c0803efde187994721aef0713a702a54965",
            "output_base64sha256": "SZKXcezEPm4VUUHja2L+rRhNoQkJWPCTnQ+B8fOUWhk=",
            "output_base64sha512": "lJq/QxVoEq6xOcUMeS+qz64DXphQOjgGH8rUryoVDvHToRqTeq7dmbM2jwPWCTK/dSaSjGpJ+U+CTo26O4awDg==",
            "output_file_mode": null,
            "output_md5": "9875a1774bceae769ec1aa582895d6cc",
            "output_path": "./.terraform/lambda.zip",
            "output_sha": "2cab8c0803efde187994721aef0713a702a54965",
            "output_sha256": "49929771ecc43e6e155141e36b62fead184da1090958f0939d0f81f1f3945a19",
            "output_sha512": "949abf43156812aeb139c50c792faacfae035e98503a38061fcad4af2a150ef1d3a11a937aaedd99b3368f03d60932bf7526928c6a49f94f824e8dba3b86b00e",
            "output_size": 4091,
            "source": [
              {
                "content": "\"\"\"Lambda handler for Bedrock Agent action groups.\n\nHandles booking, approval, and notification actions.\n\"\"\"\n\nimport json\nimport os\nimport uuid\nfrom datetime import datetime, timedelta\n\nimport boto3\n\n# Initialize clients\ndynamodb = boto3.resource(\"dynamodb\")\nses = boto3.client(\"ses\")\nsns = boto3.client(\"sns\")\nlocation = boto3.client(\"geo-places\")\n\nBOOKINGS_TABLE = os.environ.get(\"BOOKINGS_TABLE\", \"nhs-booking-demo-bookings\")\nSESSIONS_TABLE = os.environ.get(\"SESSIONS_TABLE\", \"nhs-booking-demo-sessions\")\n\n\ndef handler(event, context):\n    \"\"\"Main Lambda handler for Bedrock Agent actions.\"\"\"\n    \n    print(f\"Event: {json.dumps(event)}\")\n    \n    # Extract action details\n    action_group = event.get(\"actionGroup\", \"\")\n    api_path = event.get(\"apiPath\", \"\")\n    parameters = event.get(\"requestBody\", {}).get(\"content\", {}).get(\"application/json\", {}).get(\"properties\", [])\n    \n    # Convert parameters list to dict\n    params = {p[\"name\"]: p[\"value\"] for p in parameters}\n    \n    # Route to appropriate handler\n    handlers = {\n        # Booking actions\n        \"/check-availability\": check_availability,\n        \"/create-booking\": create_booking,\n        # Approval actions\n        \"/validate-booking\": validate_booking,\n        \"/approve-booking\": approve_booking,\n        # Notification actions\n        \"/send-confirmation\": send_confirmation,\n        \"/send-letter\": send_letter,\n        # Location actions\n        \"/find-nearby-hospitals\": find_nearby_hospitals,\n    }\n    \n    handler_func = handlers.get(api_path)\n    if handler_func:\n        result = handler_func(params)\n    else:\n        result = {\"error\": f\"Unknown action: {api_path}\"}\n    \n    # Format response for Bedrock Agent\n    return {\n        \"messageVersion\": \"1.0\",\n        \"response\": {\n            \"actionGroup\": action_group,\n            \"apiPath\": api_path,\n            \"httpMethod\": \"POST\",\n            \"httpStatusCode\": 200,\n            \"responseBody\": {\n                \"application/json\": {\n                    \"body\": json.dumps(result)\n                }\n            }\n        }\n    }\n\n\n# ============ Booking Actions ============\n\ndef check_availability(params):\n    \"\"\"Check available appointment slots.\"\"\"\n    \n    appointment_type = params.get(\"appointment_type\", \"gp\")\n    preferred_date = params.get(\"preferred_date\", \"\")\n    urgency = params.get(\"urgency\", \"routine\")\n    \n    # Generate mock availability (in production, query real system)\n    today = datetime.now()\n    slots = []\n    \n    if urgency == \"urgent\":\n        # Same day or next day for urgent\n        for i in range(2):\n            date = today + timedelta(days=i)\n            slots.append({\n                \"date\": date.strftime(\"%Y-%m-%d\"),\n                \"time\": \"09:30\" if i == 0 else \"14:00\",\n                \"doctor\": \"Dr. Smith (Duty GP)\",\n                \"type\": \"urgent\"\n            })\n    else:\n        # 1-2 weeks out for routine\n        for i in range(7, 14, 2):\n            date = today + timedelta(days=i)\n            if date.weekday() \u003c 5:  # Weekdays\n                slots.append({\n                    \"date\": date.strftime(\"%Y-%m-%d\"),\n                    \"time\": \"10:00\",\n                    \"doctor\": \"Dr. Johnson\" if i % 4 == 0 else \"Dr. Williams\",\n                    \"type\": \"routine\"\n                })\n    \n    return {\n        \"available_slots\": slots[:3],\n        \"appointment_type\": appointment_type,\n        \"message\": f\"Found {len(slots[:3])} available slots for {appointment_type} appointment\"\n    }\n\n\ndef create_booking(params):\n    \"\"\"Create a new booking.\"\"\"\n    \n    booking_id = f\"NHS-{datetime.now().strftime('%Y%m%d')}-{uuid.uuid4().hex[:6].upper()}\"\n    \n    booking = {\n        \"booking_id\": booking_id,\n        \"patient_name\": params.get(\"patient_name\", \"Unknown\"),\n        \"appointment_type\": params.get(\"appointment_type\", \"gp\"),\n        \"date\": params.get(\"date\", \"\"),\n        \"time\": params.get(\"time\", \"\"),\n        \"reason\": params.get(\"reason\", \"\"),\n        \"status\": \"pending\",\n        \"created_at\": datetime.now().isoformat()\n    }\n    \n    # Save to DynamoDB\n    try:\n        table = dynamodb.Table(BOOKINGS_TABLE)\n        table.put_item(Item=booking)\n    except Exception as e:\n        print(f\"DynamoDB error: {e}\")\n    \n    return {\n        \"booking_id\": booking_id,\n        \"status\": \"pending\",\n        \"message\": f\"Booking {booking_id} created. Awaiting approval.\"\n    }\n\n\n# ============ Approval Actions ============\n\ndef validate_booking(params):\n    \"\"\"Validate a booking request.\"\"\"\n    \n    booking_id = params.get(\"booking_id\", \"\")\n    \n    # Get booking from DynamoDB\n    try:\n        table = dynamodb.Table(BOOKINGS_TABLE)\n        response = table.get_item(Key={\"booking_id\": booking_id})\n        booking = response.get(\"Item\", {})\n    except Exception:\n        booking = {}\n    \n    if not booking:\n        return {\"valid\": False, \"reason\": \"Booking not found\"}\n    \n    # Simple validation rules\n    issues = []\n    \n    if not booking.get(\"patient_name\"):\n        issues.append(\"Patient name required\")\n    if not booking.get(\"date\"):\n        issues.append(\"Appointment date required\")\n    if not booking.get(\"time\"):\n        issues.append(\"Appointment time required\")\n    \n    if issues:\n        return {\n            \"valid\": False,\n            \"booking_id\": booking_id,\n            \"issues\": issues\n        }\n    \n    return {\n        \"valid\": True,\n        \"booking_id\": booking_id,\n        \"message\": \"Booking validated successfully\"\n    }\n\n\ndef approve_booking(params):\n    \"\"\"Approve a validated booking.\"\"\"\n    \n    booking_id = params.get(\"booking_id\", \"\")\n    \n    # Update booking status\n    try:\n        table = dynamodb.Table(BOOKINGS_TABLE)\n        table.update_item(\n            Key={\"booking_id\": booking_id},\n            UpdateExpression=\"SET #status = :status, approved_at = :time\",\n            ExpressionAttributeNames={\"#status\": \"status\"},\n            ExpressionAttributeValues={\n                \":status\": \"approved\",\n                \":time\": datetime.now().isoformat()\n            }\n        )\n        \n        # Get updated booking\n        response = table.get_item(Key={\"booking_id\": booking_id})\n        booking = response.get(\"Item\", {})\n        \n    except Exception as e:\n        print(f\"Approval error: {e}\")\n        return {\"approved\": False, \"error\": str(e)}\n    \n    return {\n        \"approved\": True,\n        \"booking_id\": booking_id,\n        \"date\": booking.get(\"date\", \"\"),\n        \"time\": booking.get(\"time\", \"\"),\n        \"message\": f\"Booking {booking_id} has been approved and confirmed.\"\n    }\n\n\n# ============ Notification Actions ============\n\ndef send_confirmation(params):\n    \"\"\"Send booking confirmation via email and SMS.\"\"\"\n    \n    booking_id = params.get(\"booking_id\", \"\")\n    email = params.get(\"email\", \"\")\n    phone = params.get(\"phone\", \"\")\n    \n    # Get booking details\n    try:\n        table = dynamodb.Table(BOOKINGS_TABLE)\n        response = table.get_item(Key={\"booking_id\": booking_id})\n        booking = response.get(\"Item\", {})\n    except Exception:\n        booking = {}\n    \n    if not booking:\n        return {\"sent\": False, \"error\": \"Booking not found\"}\n    \n    # Format confirmation message\n    message = f\"\"\"\nNHS Appointment Confirmation\n\nReference: {booking_id}\nDate: {booking.get('date', 'TBC')}\nTime: {booking.get('time', 'TBC')}\nType: {booking.get('appointment_type', 'GP').upper()} Appointment\n\nPlease arrive 10 minutes early.\nTo cancel, call the surgery or reply to this message.\n    \"\"\".strip()\n    \n    sent_to = []\n    \n    # Send email (demo - would use SES in production)\n    if email:\n        print(f\"[DEMO] Would send email to {email}\")\n        sent_to.append(f\"email:{email}\")\n    \n    # Send SMS (demo - would use SNS in production)\n    if phone:\n        print(f\"[DEMO] Would send SMS to {phone}\")\n        sent_to.append(f\"sms:{phone}\")\n    \n    return {\n        \"sent\": True,\n        \"booking_id\": booking_id,\n        \"sent_to\": sent_to,\n        \"message\": \"Confirmation sent successfully\"\n    }\n\n\ndef send_letter(params):\n    \"\"\"Send a letter via email.\"\"\"\n    \n    booking_id = params.get(\"booking_id\", \"\")\n    letter_type = params.get(\"letter_type\", \"confirmation\")\n    email = params.get(\"email\", \"\")\n    \n    # Get booking details\n    try:\n        table = dynamodb.Table(BOOKINGS_TABLE)\n        response = table.get_item(Key={\"booking_id\": booking_id})\n        booking = response.get(\"Item\", {})\n    except Exception:\n        booking = {}\n    \n    # Generate letter content based on type\n    letters = {\n        \"confirmation\": f\"\"\"\nDear {booking.get('patient_name', 'Patient')},\n\nThis letter confirms your appointment.\n\nReference: {booking_id}\nDate: {booking.get('date', 'TBC')}\nTime: {booking.get('time', 'TBC')}\n\nPlease bring any relevant documents or test results.\n\nYours sincerely,\nNHS Patient Booking System\n        \"\"\",\n        \"referral\": f\"\"\"\nDear Colleague,\n\nI am referring {booking.get('patient_name', 'this patient')} for specialist assessment.\n\nReason: {booking.get('reason', 'As discussed')}\n\nPlease arrange an appointment at your earliest convenience.\n\nYours sincerely,\nGP Surgery\n        \"\"\",\n        \"follow-up\": f\"\"\"\nDear {booking.get('patient_name', 'Patient')},\n\nFollowing your recent appointment, please note the following:\n\n{booking.get('reason', 'Please contact the surgery if you have any questions.')}\n\nYours sincerely,\nNHS Patient Booking System\n        \"\"\"\n    }\n    \n    letter_content = letters.get(letter_type, letters[\"confirmation\"])\n    \n    print(f\"[DEMO] Would send {letter_type} letter to {email}\")\n    \n    return {\n        \"sent\": True,\n        \"booking_id\": booking_id,\n        \"letter_type\": letter_type,\n        \"message\": f\"{letter_type.title()} letter sent to {email}\"\n    }\n\n\n# ============ Location Actions ============\n\ndef find_nearby_hospitals(params):\n    \"\"\"Find nearby hospitals using Amazon Location Service.\n    \n    Requires patient address to geocode and find nearby NHS facilities.\n    \"\"\"\n    \n    patient_name = params.get(\"patient_name\", \"\")\n    patient_address = params.get(\"patient_address\", \"\")\n    max_results = int(params.get(\"max_results\", 5))\n    \n    if not patient_address:\n        return {\n            \"success\": False,\n            \"error\": \"Patient address is required to find nearby hospitals\",\n            \"required_info\": [\"patient_name\", \"patient_address\"]\n        }\n    \n    try:\n        # First, geocode the patient's address to get coordinates\n        geocode_response = location.geocode(\n            QueryText=patient_address,\n            MaxResults=1,\n            Filter={\n                \"IncludeCountries\": [\"GBR\"]  # UK only\n            }\n        )\n        \n        if not geocode_response.get(\"ResultItems\"):\n            return {\n                \"success\": False,\n                \"error\": f\"Could not find location for address: {patient_address}\",\n                \"suggestion\": \"Please provide a more specific UK address including postcode\"\n            }\n        \n        # Get coordinates from geocode result\n        position = geocode_response[\"ResultItems\"][0][\"Position\"]\n        longitude, latitude = position[0], position[1]\n        \n        # Search for nearby hospitals\n        search_response = location.search_nearby(\n            QueryPosition=[longitude, latitude],\n            MaxResults=max_results,\n            Filter={\n                \"IncludeCategories\": [\"hospital\", \"medical-center\", \"health-care\"]\n            }\n        )\n        \n        hospitals = []\n        for item in search_response.get(\"ResultItems\", []):\n            hospital = {\n                \"name\": item.get(\"Title\", \"Unknown Hospital\"),\n                \"address\": item.get(\"Address\", {}).get(\"Label\", \"\"),\n                \"distance_km\": round(item.get(\"Distance\", 0) / 1000, 1),\n                \"phone\": item.get(\"Contacts\", {}).get(\"Phones\", [{}])[0].get(\"Value\", \"\"),\n                \"categories\": item.get(\"Categories\", [])\n            }\n            hospitals.append(hospital)\n        \n        return {\n            \"success\": True,\n            \"patient_name\": patient_name,\n            \"search_location\": patient_address,\n            \"coordinates\": {\"latitude\": latitude, \"longitude\": longitude},\n            \"nearby_hospitals\": hospitals,\n            \"message\": f\"Found {len(hospitals)} NHS facilities near {patient_address}\"\n        }\n        \n    except Exception as e:\n        # Fallback to mock data if Location Service not configured or errors\n        print(f\"Location Service error: {e}\")\n        return _mock_nearby_hospitals(patient_name, patient_address)\n\n\ndef _mock_nearby_hospitals(patient_name, patient_address):\n    \"\"\"Return mock hospital data for demo purposes.\"\"\"\n    \n    mock_hospitals = [\n        {\n            \"name\": \"St Thomas' Hospital\",\n            \"address\": \"Westminster Bridge Rd, London SE1 7EH\",\n            \"distance_km\": 1.2,\n            \"phone\": \"020 7188 7188\",\n            \"nhs_trust\": \"Guy's and St Thomas' NHS Foundation Trust\",\n            \"services\": [\"A\u0026E\", \"GP\", \"Specialist\"]\n        },\n        {\n            \"name\": \"Guy's Hospital\",\n            \"address\": \"Great Maze Pond, London SE1 9RT\",\n            \"distance_km\": 1.8,\n            \"phone\": \"020 7188 7188\",\n            \"nhs_trust\": \"Guy's and St Thomas' NHS Foundation Trust\",\n            \"services\": [\"Specialist\", \"Outpatient\"]\n        },\n        {\n            \"name\": \"King's College Hospital\",\n            \"address\": \"Denmark Hill, London SE5 9RS\",\n            \"distance_km\": 3.5,\n            \"phone\": \"020 3299 9000\",\n            \"nhs_trust\": \"King's College Hospital NHS Foundation Trust\",\n            \"services\": [\"A\u0026E\", \"GP\", \"Specialist\"]\n        },\n        {\n            \"name\": \"Riverside Health Centre\",\n            \"address\": \"St George Wharf, London SW8 2LE\",\n            \"distance_km\": 2.1,\n            \"phone\": \"020 7411 1234\",\n            \"nhs_trust\": \"NHS South West London\",\n            \"services\": [\"GP\", \"Walk-in\"]\n        },\n        {\n            \"name\": \"Lambeth Walk Group Practice\",\n            \"address\": \"6 Lambeth Walk, London SE11 6DU\",\n            \"distance_km\": 0.8,\n            \"phone\": \"020 7735 4545\",\n            \"nhs_trust\": \"NHS South East London\",\n            \"services\": [\"GP\"]\n        }\n    ]\n    \n    return {\n        \"success\": True,\n        \"patient_name\": patient_name,\n        \"search_location\": patient_address,\n        \"nearby_hospitals\": mock_hospitals,\n        \"message\": f\"Found {len(mock_hospitals)} NHS facilities near {patient_address}\",\n        \"note\": \"Demo data - in production, uses Amazon Location Service\"\n    }\n",
                "filename": "lambda_actions.py"
              }
            ],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": null,
            "source_file": null,
            "type": "zip"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "data",
      "type": "aws_caller_identity",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "376337229415",
            "arn": "arn:aws:iam::376337229415:user/ryankarlos",
            "id": "376337229415",
            "user_id": "AIDAVPH3SMZTWPJBBVECF"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "data",
      "type": "aws_region",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "US East (N. Virginia)",
            "endpoint": "ec2.us-east-1.amazonaws.com",
            "id": "us-east-1",
            "name": "us-east-1",
            "region": "us-east-1"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent",
      "name": "information",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_arn": "arn:aws:bedrock:us-east-1:376337229415:agent/E90JQ9YHKP",
            "agent_collaboration": "DISABLED",
            "agent_id": "E90JQ9YHKP",
            "agent_name": "nhs-booking-demo-info-agent",
            "agent_resource_role_arn": "arn:aws:iam::376337229415:role/nhs-booking-demo-bedrock-agent-role",
            "agent_version": null,
            "customer_encryption_key_arn": null,
            "description": "Information specialist for NHS queries",
            "foundation_model": "amazon.nova-lite-v1:0",
            "guardrail_configuration": null,
            "id": "E90JQ9YHKP",
            "idle_session_ttl_in_seconds": 300,
            "instruction": "You are an NHS Information Specialist. Your role is to answer questions about NHS services.\n\nRESPONSIBILITIES:\n1. Search the knowledge base for NHS information\n2. Explain appointment types (GP, specialist, urgent, routine)\n3. Describe what patients should bring to appointments\n4. Explain the patient flow and booking process\n5. Provide information about nearby facilities\n\nIMPORTANT:\n- You do NOT provide medical advice\n- For health questions, direct patients to NHS 111 or nhs.uk\n- Always cite the knowledge base when providing information\n- Be helpful and reassuring in your responses\n",
            "memory_configuration": null,
            "prepare_agent": true,
            "prepared_at": "2026-01-05T20:52:40Z",
            "prompt_override_configuration": [
              {
                "override_lambda": null,
                "prompt_configurations": null
              }
            ],
            "region": "us-east-1",
            "skip_resource_in_use_check": false,
            "tags": null,
            "tags_all": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_iam_role.bedrock_agent",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent",
      "name": "scheduling",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_arn": "arn:aws:bedrock:us-east-1:376337229415:agent/9ESYPRBHBS",
            "agent_collaboration": "DISABLED",
            "agent_id": "9ESYPRBHBS",
            "agent_name": "nhs-booking-demo-scheduling-agent",
            "agent_resource_role_arn": "arn:aws:iam::376337229415:role/nhs-booking-demo-bedrock-agent-role",
            "agent_version": null,
            "customer_encryption_key_arn": null,
            "description": "Scheduling specialist for booking appointments",
            "foundation_model": "amazon.nova-lite-v1:0",
            "guardrail_configuration": null,
            "id": "9ESYPRBHBS",
            "idle_session_ttl_in_seconds": 300,
            "instruction": "You are an NHS Scheduling Specialist. Your role is to find and book appointments.\n\nRESPONSIBILITIES:\n1. Check availability based on urgency level from triage\n2. Present multiple options to patients (different times, doctors, locations)\n3. Handle booking conflicts by offering alternatives\n4. Create and confirm bookings\n5. Find nearby hospitals when patients need alternatives\n\nWHEN SLOTS ARE UNAVAILABLE:\n- Never simply reject a request\n- Offer alternative times on the same day\n- Suggest different doctors with earlier availability\n- Recommend nearby clinics or hospitals\n- For urgent cases, escalate to find emergency slots\n\nFINDING NEARBY HOSPITALS:\nWhen a patient needs to find nearby NHS facilities:\n1. Ask for their full name if not provided\n2. Ask for their full address including postcode\n3. Use findNearbyHospitals action with their details\n4. Present results with distance and available services\n\nBOOKING CONFIRMATION:\n- Verify all patient details before confirming\n- Provide clear booking reference\n- Explain what to bring to the appointment\n",
            "memory_configuration": null,
            "prepare_agent": true,
            "prepared_at": "2026-01-05T22:18:07Z",
            "prompt_override_configuration": [
              {
                "override_lambda": null,
                "prompt_configurations": null
              }
            ],
            "region": "us-east-1",
            "skip_resource_in_use_check": false,
            "tags": null,
            "tags_all": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_iam_role.bedrock_agent",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent",
      "name": "supervisor",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_arn": "arn:aws:bedrock:us-east-1:376337229415:agent/P7QFL8LKUN",
            "agent_collaboration": "DISABLED",
            "agent_id": "P7QFL8LKUN",
            "agent_name": "nhs-booking-demo-agent",
            "agent_resource_role_arn": "arn:aws:iam::376337229415:role/nhs-booking-demo-bedrock-agent-role",
            "agent_version": null,
            "customer_encryption_key_arn": null,
            "description": "NHS Patient Booking Assistant with Web Search",
            "foundation_model": "us.amazon.nova-premier-v1:0",
            "guardrail_configuration": null,
            "id": "P7QFL8LKUN",
            "idle_session_ttl_in_seconds": 600,
            "instruction": "You are an NHS Patient Booking Assistant. Help patients book GP and specialist appointments.\n\nIMPORTANT RULES:\n1. You do NOT provide medical advice - only help with bookings\n2. Be polite, professional, and reassuring\n3. Keep patients updated on what you're doing\n\nBOOKING WORKFLOW:\n1. Understand the patient's booking need (GP or specialist)\n2. Check availability using the checkAvailability action\n3. Create the booking using createBooking action\n4. Approve it using approveBooking action\n5. Send confirmation using sendConfirmation action\n\nFINDING NEARBY HOSPITALS:\nWhen a patient asks about nearby hospitals, clinics, or NHS facilities:\n1. First ask for their full name if not already provided\n2. Ask for their full address including postcode (e.g., \"10 Downing Street, London SW1A 2AA\")\n3. Use the findNearbyHospitals action with their name and address\n4. Present the results showing hospital name, distance, and services available\n\nWEB SEARCH:\nYou have access to real-time web search. Use it to:\n- Find current NHS service information and opening hours\n- Look up specific hospital or clinic details\n- Get up-to-date NHS guidance and policies\n- Search for NHS services in specific areas\nAlways cite your sources when providing web search results.\n\nEMERGENCY: For urgent symptoms (chest pain, breathing difficulty, stroke signs), \nimmediately advise calling 999 - do NOT proceed with booking.\n\nWhen patients ask about NHS services, appointment types, or patient flow:\n- First search the knowledge base for relevant information\n- Use web search for current/real-time information\n- Always clarify you cannot give medical advice\n",
            "memory_configuration": null,
            "prepare_agent": true,
            "prepared_at": "2026-01-05T22:18:07Z",
            "prompt_override_configuration": [
              {
                "override_lambda": null,
                "prompt_configurations": null
              }
            ],
            "region": "us-east-1",
            "skip_resource_in_use_check": false,
            "tags": null,
            "tags_all": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_iam_role.bedrock_agent",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent",
      "name": "supervisor_multi",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_arn": "arn:aws:bedrock:us-east-1:376337229415:agent/R5CKKTHOFB",
            "agent_collaboration": "SUPERVISOR",
            "agent_id": "R5CKKTHOFB",
            "agent_name": "nhs-booking-demo-supervisor",
            "agent_resource_role_arn": "arn:aws:iam::376337229415:role/nhs-booking-demo-bedrock-agent-role",
            "agent_version": null,
            "customer_encryption_key_arn": null,
            "description": "Supervisor agent with web search orchestrating NHS booking workflow",
            "foundation_model": "us.amazon.nova-premier-v1:0",
            "guardrail_configuration": null,
            "id": "R5CKKTHOFB",
            "idle_session_ttl_in_seconds": 600,
            "instruction": "You are the NHS Patient Booking Supervisor. You coordinate a team of specialist agents.\n\nYOUR TEAM:\n1. TRIAGE AGENT - Assesses urgency of patient requests\n2. SCHEDULING AGENT - Handles availability and bookings  \n3. INFORMATION AGENT - Answers questions about NHS services\n\nWORKFLOW:\n1. Greet the patient warmly\n2. If patient describes symptoms or health concerns:\n   - Route to TRIAGE AGENT to assess urgency\n   - If emergency, advise 999 immediately\n3. For booking requests:\n   - Get urgency from TRIAGE if not already assessed\n   - Route to SCHEDULING AGENT to find slots and book\n4. For questions about NHS services:\n   - Route to INFORMATION AGENT\n   - Use web search for current/real-time NHS information\n5. Summarize outcomes and confirm next steps with patient\n\nWEB SEARCH:\nYou have access to real-time web search. Use it to:\n- Find current NHS service information and opening hours\n- Look up specific hospital or clinic details\n- Get up-to-date NHS guidance and policies\n- Search for NHS services in specific areas\nAlways cite your sources when providing web search results.\n\nIMPORTANT:\n- Keep the patient informed about what you're doing\n- Be empathetic and professional\n- Never provide medical advice yourself\n- Ensure smooth handoffs between agents\n",
            "memory_configuration": null,
            "prepare_agent": false,
            "prepared_at": "2026-01-05T21:13:16Z",
            "prompt_override_configuration": [
              {
                "override_lambda": null,
                "prompt_configurations": null
              }
            ],
            "region": "us-east-1",
            "skip_resource_in_use_check": false,
            "tags": null,
            "tags_all": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_iam_role.bedrock_agent",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent",
      "name": "triage",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_arn": "arn:aws:bedrock:us-east-1:376337229415:agent/MR73PAVETH",
            "agent_collaboration": "DISABLED",
            "agent_id": "MR73PAVETH",
            "agent_name": "nhs-booking-demo-triage-agent",
            "agent_resource_role_arn": "arn:aws:iam::376337229415:role/nhs-booking-demo-bedrock-agent-role",
            "agent_version": null,
            "customer_encryption_key_arn": null,
            "description": "Triage specialist for assessing patient urgency",
            "foundation_model": "amazon.nova-lite-v1:0",
            "guardrail_configuration": null,
            "id": "MR73PAVETH",
            "idle_session_ttl_in_seconds": 300,
            "instruction": "You are an NHS Triage Specialist. Your role is to assess patient requests and determine urgency.\n\nTRIAGE CATEGORIES:\n1. EMERGENCY - Chest pain, breathing difficulty, stroke symptoms, severe bleeding\n   Action: Immediately advise calling 999, do not proceed with booking\n    \n2. URGENT - High fever, severe pain, worsening symptoms, mental health crisis\n   Action: Same-day or next-day appointment required\n    \n3. ROUTINE - Ongoing conditions, follow-ups, general health concerns\n   Action: Standard appointment within 1-2 weeks\n\nASSESSMENT PROCESS:\n- Ask clarifying questions about symptoms if needed\n- Consider duration and severity of symptoms\n- Check for red flag symptoms that require emergency care\n- Return urgency level and recommended appointment type\n\nYou do NOT provide medical advice or diagnoses. Only assess urgency for booking purposes.\n",
            "memory_configuration": null,
            "prepare_agent": true,
            "prepared_at": "2026-01-05T20:52:41Z",
            "prompt_override_configuration": [
              {
                "override_lambda": null,
                "prompt_configurations": null
              }
            ],
            "region": "us-east-1",
            "skip_resource_in_use_check": false,
            "tags": null,
            "tags_all": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_iam_role.bedrock_agent",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent_action_group",
      "name": "booking",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "action_group_executor": [
              {
                "custom_control": null,
                "lambda": "arn:aws:lambda:us-east-1:376337229415:function:nhs-booking-demo-actions"
              }
            ],
            "action_group_id": "RS93P9JKFW",
            "action_group_name": "BookingActions",
            "action_group_state": "ENABLED",
            "agent_id": "P7QFL8LKUN",
            "agent_version": "DRAFT",
            "api_schema": [
              {
                "payload": "{\"info\":{\"title\":\"NHS Booking API\",\"version\":\"1.0.0\"},\"openapi\":\"3.0.0\",\"paths\":{\"/approve-booking\":{\"post\":{\"description\":\"Approve and confirm a booking\",\"operationId\":\"approveBooking\",\"requestBody\":{\"content\":{\"application/json\":{\"schema\":{\"properties\":{\"booking_id\":{\"description\":\"Booking reference\",\"type\":\"string\"}},\"required\":[\"booking_id\"],\"type\":\"object\"}}},\"required\":true},\"responses\":{\"200\":{\"description\":\"Booking approved\"}}}},\"/check-availability\":{\"post\":{\"description\":\"Check available appointment slots for GP or specialist\",\"operationId\":\"checkAvailability\",\"requestBody\":{\"content\":{\"application/json\":{\"schema\":{\"properties\":{\"appointment_type\":{\"description\":\"gp or specialist\",\"type\":\"string\"},\"urgency\":{\"description\":\"routine or urgent\",\"type\":\"string\"}},\"type\":\"object\"}}},\"required\":true},\"responses\":{\"200\":{\"description\":\"Available slots returned\"}}}},\"/create-booking\":{\"post\":{\"description\":\"Create a new appointment booking\",\"operationId\":\"createBooking\",\"requestBody\":{\"content\":{\"application/json\":{\"schema\":{\"properties\":{\"appointment_type\":{\"description\":\"gp or specialist\",\"type\":\"string\"},\"date\":{\"description\":\"Date YYYY-MM-DD\",\"type\":\"string\"},\"patient_name\":{\"description\":\"Patient full name\",\"type\":\"string\"},\"reason\":{\"description\":\"Reason for appointment\",\"type\":\"string\"},\"time\":{\"description\":\"Time HH:MM\",\"type\":\"string\"}},\"required\":[\"patient_name\",\"date\",\"time\"],\"type\":\"object\"}}},\"required\":true},\"responses\":{\"200\":{\"description\":\"Booking created\"}}}},\"/find-nearby-hospitals\":{\"post\":{\"description\":\"Find nearby NHS hospitals and clinics based on patient address. IMPORTANT: You must ask the patient for their name and full address (including postcode) before calling this action.\",\"operationId\":\"findNearbyHospitals\",\"requestBody\":{\"content\":{\"application/json\":{\"schema\":{\"properties\":{\"max_results\":{\"description\":\"Maximum number of hospitals to return (default 5)\",\"type\":\"integer\"},\"patient_address\":{\"description\":\"Patient full address including postcode (e.g., '10 Downing Street, London SW1A 2AA')\",\"type\":\"string\"},\"patient_name\":{\"description\":\"Patient full name\",\"type\":\"string\"}},\"required\":[\"patient_name\",\"patient_address\"],\"type\":\"object\"}}},\"required\":true},\"responses\":{\"200\":{\"description\":\"List of nearby hospitals with distance and contact info\"}}}},\"/send-confirmation\":{\"post\":{\"description\":\"Send booking confirmation via email/SMS\",\"operationId\":\"sendConfirmation\",\"requestBody\":{\"content\":{\"application/json\":{\"schema\":{\"properties\":{\"booking_id\":{\"description\":\"Booking reference\",\"type\":\"string\"},\"email\":{\"description\":\"Patient email\",\"type\":\"string\"},\"phone\":{\"description\":\"Patient phone\",\"type\":\"string\"}},\"required\":[\"booking_id\"],\"type\":\"object\"}}},\"required\":true},\"responses\":{\"200\":{\"description\":\"Confirmation sent\"}}}}}}",
                "s3": []
              }
            ],
            "description": "Actions for booking appointments",
            "function_schema": [],
            "id": "RS93P9JKFW,P7QFL8LKUN,DRAFT",
            "parent_action_group_signature": null,
            "prepare_agent": true,
            "region": "us-east-1",
            "skip_resource_in_use_check": false,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.supervisor",
            "aws_dynamodb_table.bookings",
            "aws_dynamodb_table.sessions",
            "aws_iam_role.bedrock_agent",
            "aws_iam_role.lambda",
            "aws_lambda_function.actions",
            "data.archive_file.lambda",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent_action_group",
      "name": "scheduling_actions",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "action_group_executor": [
              {
                "custom_control": null,
                "lambda": "arn:aws:lambda:us-east-1:376337229415:function:nhs-booking-demo-actions"
              }
            ],
            "action_group_id": "FDKEJYAI7X",
            "action_group_name": "SchedulingActions",
            "action_group_state": "ENABLED",
            "agent_id": "9ESYPRBHBS",
            "agent_version": "DRAFT",
            "api_schema": [
              {
                "payload": "{\"info\":{\"title\":\"NHS Scheduling API\",\"version\":\"1.0.0\"},\"openapi\":\"3.0.0\",\"paths\":{\"/approve-booking\":{\"post\":{\"description\":\"Approve and confirm booking\",\"operationId\":\"approveBooking\",\"requestBody\":{\"content\":{\"application/json\":{\"schema\":{\"properties\":{\"booking_id\":{\"type\":\"string\"}},\"required\":[\"booking_id\"],\"type\":\"object\"}}},\"required\":true},\"responses\":{\"200\":{\"description\":\"Booking approved\"}}}},\"/check-availability\":{\"post\":{\"description\":\"Check available appointment slots\",\"operationId\":\"checkAvailability\",\"requestBody\":{\"content\":{\"application/json\":{\"schema\":{\"properties\":{\"appointment_type\":{\"type\":\"string\"},\"preferred_date\":{\"type\":\"string\"},\"preferred_doctor\":{\"type\":\"string\"},\"urgency\":{\"type\":\"string\"}},\"type\":\"object\"}}},\"required\":true},\"responses\":{\"200\":{\"description\":\"Available slots\"}}}},\"/create-booking\":{\"post\":{\"description\":\"Create appointment booking\",\"operationId\":\"createBooking\",\"requestBody\":{\"content\":{\"application/json\":{\"schema\":{\"properties\":{\"date\":{\"type\":\"string\"},\"doctor\":{\"type\":\"string\"},\"patient_name\":{\"type\":\"string\"},\"reason\":{\"type\":\"string\"},\"time\":{\"type\":\"string\"}},\"required\":[\"patient_name\",\"date\",\"time\"],\"type\":\"object\"}}},\"required\":true},\"responses\":{\"200\":{\"description\":\"Booking created\"}}}},\"/find-nearby-hospitals\":{\"post\":{\"description\":\"Find nearby NHS hospitals and clinics. Ask patient for name and full address with postcode first.\",\"operationId\":\"findNearbyHospitals\",\"requestBody\":{\"content\":{\"application/json\":{\"schema\":{\"properties\":{\"max_results\":{\"type\":\"integer\"},\"patient_address\":{\"description\":\"Full address with postcode\",\"type\":\"string\"},\"patient_name\":{\"description\":\"Patient full name\",\"type\":\"string\"}},\"required\":[\"patient_name\",\"patient_address\"],\"type\":\"object\"}}},\"required\":true},\"responses\":{\"200\":{\"description\":\"Nearby hospitals\"}}}}}}",
                "s3": []
              }
            ],
            "description": "Actions for scheduling appointments",
            "function_schema": [],
            "id": "FDKEJYAI7X,9ESYPRBHBS,DRAFT",
            "parent_action_group_signature": null,
            "prepare_agent": true,
            "region": "us-east-1",
            "skip_resource_in_use_check": false,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.scheduling",
            "aws_dynamodb_table.bookings",
            "aws_dynamodb_table.sessions",
            "aws_iam_role.bedrock_agent",
            "aws_iam_role.lambda",
            "aws_lambda_function.actions",
            "data.archive_file.lambda",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent_alias",
      "name": "information_live",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_alias_arn": "arn:aws:bedrock:us-east-1:376337229415:agent-alias/E90JQ9YHKP/0QJHFAMCRV",
            "agent_alias_id": "0QJHFAMCRV",
            "agent_alias_name": "live",
            "agent_id": "E90JQ9YHKP",
            "description": "Live alias for information agent",
            "id": "0QJHFAMCRV,E90JQ9YHKP",
            "region": "us-east-1",
            "routing_configuration": [
              {
                "agent_version": "1",
                "provisioned_throughput": null
              }
            ],
            "tags": null,
            "tags_all": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.information",
            "aws_iam_role.bedrock_agent",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent_alias",
      "name": "live",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_alias_arn": "arn:aws:bedrock:us-east-1:376337229415:agent-alias/P7QFL8LKUN/QGFY7425NI",
            "agent_alias_id": "QGFY7425NI",
            "agent_alias_name": "live",
            "agent_id": "P7QFL8LKUN",
            "description": "Live alias",
            "id": "QGFY7425NI,P7QFL8LKUN",
            "region": "us-east-1",
            "routing_configuration": [
              {
                "agent_version": "1",
                "provisioned_throughput": null
              }
            ],
            "tags": null,
            "tags_all": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.supervisor",
            "aws_bedrockagent_agent_action_group.booking",
            "aws_dynamodb_table.bookings",
            "aws_dynamodb_table.sessions",
            "aws_iam_role.bedrock_agent",
            "aws_iam_role.lambda",
            "aws_lambda_function.actions",
            "data.archive_file.lambda",
            "data.aws_caller_identity.current",
            "null_resource.prepare_agent"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent_alias",
      "name": "scheduling_live",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_alias_arn": "arn:aws:bedrock:us-east-1:376337229415:agent-alias/9ESYPRBHBS/IEFOL2DN6G",
            "agent_alias_id": "IEFOL2DN6G",
            "agent_alias_name": "live",
            "agent_id": "9ESYPRBHBS",
            "description": "Live alias for scheduling agent",
            "id": "IEFOL2DN6G,9ESYPRBHBS",
            "region": "us-east-1",
            "routing_configuration": [
              {
                "agent_version": "3",
                "provisioned_throughput": null
              }
            ],
            "tags": null,
            "tags_all": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.scheduling",
            "aws_iam_role.bedrock_agent",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent_alias",
      "name": "supervisor_multi_live",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_alias_arn": "arn:aws:bedrock:us-east-1:376337229415:agent-alias/R5CKKTHOFB/CWU2HM8ITH",
            "agent_alias_id": "CWU2HM8ITH",
            "agent_alias_name": "live",
            "agent_id": "R5CKKTHOFB",
            "description": "Live alias for supervisor",
            "id": "CWU2HM8ITH,R5CKKTHOFB",
            "region": "us-east-1",
            "routing_configuration": [
              {
                "agent_version": "4",
                "provisioned_throughput": null
              }
            ],
            "tags": null,
            "tags_all": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.information",
            "aws_bedrockagent_agent.scheduling",
            "aws_bedrockagent_agent.supervisor_multi",
            "aws_bedrockagent_agent.triage",
            "aws_bedrockagent_agent_alias.information_live",
            "aws_bedrockagent_agent_alias.scheduling_live",
            "aws_bedrockagent_agent_alias.triage_live",
            "aws_bedrockagent_agent_collaborator.information",
            "aws_bedrockagent_agent_collaborator.scheduling",
            "aws_bedrockagent_agent_collaborator.triage",
            "aws_iam_role.bedrock_agent",
            "aws_iam_role_policy.bedrock_agent_collaborator",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent_alias",
      "name": "triage_live",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_alias_arn": "arn:aws:bedrock:us-east-1:376337229415:agent-alias/MR73PAVETH/QDLALURO8K",
            "agent_alias_id": "QDLALURO8K",
            "agent_alias_name": "live",
            "agent_id": "MR73PAVETH",
            "description": "Live alias for triage agent",
            "id": "QDLALURO8K,MR73PAVETH",
            "region": "us-east-1",
            "routing_configuration": [
              {
                "agent_version": "1",
                "provisioned_throughput": null
              }
            ],
            "tags": null,
            "tags_all": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.triage",
            "aws_iam_role.bedrock_agent",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent_collaborator",
      "name": "information",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_descriptor": [
              {
                "alias_arn": "arn:aws:bedrock:us-east-1:376337229415:agent-alias/E90JQ9YHKP/0QJHFAMCRV"
              }
            ],
            "agent_id": "R5CKKTHOFB",
            "agent_version": "DRAFT",
            "collaboration_instruction": "Route questions about NHS services, appointment types, what to bring, and general NHS information to this agent.",
            "collaborator_id": "NWCMR1IFJF",
            "collaborator_name": "InformationSpecialist",
            "id": "R5CKKTHOFB,DRAFT,NWCMR1IFJF",
            "prepare_agent": true,
            "region": "us-east-1",
            "relay_conversation_history": "TO_COLLABORATOR",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.information",
            "aws_bedrockagent_agent.supervisor_multi",
            "aws_bedrockagent_agent_alias.information_live",
            "aws_iam_role.bedrock_agent",
            "aws_iam_role_policy.bedrock_agent_collaborator",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent_collaborator",
      "name": "scheduling",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_descriptor": [
              {
                "alias_arn": "arn:aws:bedrock:us-east-1:376337229415:agent-alias/9ESYPRBHBS/IEFOL2DN6G"
              }
            ],
            "agent_id": "R5CKKTHOFB",
            "agent_version": "DRAFT",
            "collaboration_instruction": "Route booking requests to this agent. Provide the urgency level from triage. It will check availability, offer alternatives, and create bookings.",
            "collaborator_id": "FGJOLHBTR3",
            "collaborator_name": "SchedulingSpecialist",
            "id": "R5CKKTHOFB,DRAFT,FGJOLHBTR3",
            "prepare_agent": true,
            "region": "us-east-1",
            "relay_conversation_history": "TO_COLLABORATOR",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.scheduling",
            "aws_bedrockagent_agent.supervisor_multi",
            "aws_bedrockagent_agent_alias.scheduling_live",
            "aws_iam_role.bedrock_agent",
            "aws_iam_role_policy.bedrock_agent_collaborator",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent_collaborator",
      "name": "triage",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_descriptor": [
              {
                "alias_arn": "arn:aws:bedrock:us-east-1:376337229415:agent-alias/MR73PAVETH/QDLALURO8K"
              }
            ],
            "agent_id": "R5CKKTHOFB",
            "agent_version": "DRAFT",
            "collaboration_instruction": "Route patient symptom descriptions and urgency assessments to this agent. It will determine if the case is emergency, urgent, or routine.",
            "collaborator_id": "TJ69VSXQAH",
            "collaborator_name": "TriageSpecialist",
            "id": "R5CKKTHOFB,DRAFT,TJ69VSXQAH",
            "prepare_agent": true,
            "region": "us-east-1",
            "relay_conversation_history": "TO_COLLABORATOR",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.supervisor_multi",
            "aws_bedrockagent_agent.triage",
            "aws_bedrockagent_agent_alias.triage_live",
            "aws_iam_role.bedrock_agent",
            "aws_iam_role_policy.bedrock_agent_collaborator",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent_knowledge_base_association",
      "name": "info_kb",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_id": "E90JQ9YHKP",
            "agent_version": "DRAFT",
            "description": "NHS services and appointment information",
            "id": "E90JQ9YHKP,DRAFT,BNGLROUXOJ",
            "knowledge_base_id": "BNGLROUXOJ",
            "knowledge_base_state": "ENABLED",
            "region": "us-east-1",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.information",
            "aws_bedrockagent_knowledge_base.nhs",
            "aws_iam_role.bedrock_agent",
            "aws_iam_role.kb_role",
            "aws_iam_role_policy.kb_policy",
            "aws_s3_bucket.kb_source",
            "aws_s3vectors_index.nhs",
            "aws_s3vectors_vector_bucket.nhs",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent_knowledge_base_association",
      "name": "nhs",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_id": "P7QFL8LKUN",
            "agent_version": "DRAFT",
            "description": "NHS services and appointment information",
            "id": "P7QFL8LKUN,DRAFT,BNGLROUXOJ",
            "knowledge_base_id": "BNGLROUXOJ",
            "knowledge_base_state": "ENABLED",
            "region": "us-east-1",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.supervisor",
            "aws_bedrockagent_knowledge_base.nhs",
            "aws_iam_role.bedrock_agent",
            "aws_iam_role.kb_role",
            "aws_iam_role_policy.kb_policy",
            "aws_s3_bucket.kb_source",
            "aws_s3vectors_index.nhs",
            "aws_s3vectors_vector_bucket.nhs",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_data_source",
      "name": "nhs",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "data_deletion_policy": "DELETE",
            "data_source_configuration": [
              {
                "confluence_configuration": [],
                "s3_configuration": [
                  {
                    "bucket_arn": "arn:aws:s3:::nhs-booking-demo-kb-source-376337229415",
                    "bucket_owner_account_id": null,
                    "inclusion_prefixes": null
                  }
                ],
                "salesforce_configuration": [],
                "share_point_configuration": [],
                "type": "S3",
                "web_configuration": []
              }
            ],
            "data_source_id": "5MD90JCUDG",
            "description": null,
            "id": "5MD90JCUDG,BNGLROUXOJ",
            "knowledge_base_id": "BNGLROUXOJ",
            "name": "nhs-booking-demo-datasource",
            "region": "us-east-1",
            "server_side_encryption_configuration": [],
            "timeouts": null,
            "vector_ingestion_configuration": [
              {
                "chunking_configuration": [
                  {
                    "chunking_strategy": "FIXED_SIZE",
                    "fixed_size_chunking_configuration": [
                      {
                        "max_tokens": 300,
                        "overlap_percentage": 20
                      }
                    ],
                    "hierarchical_chunking_configuration": [],
                    "semantic_chunking_configuration": []
                  }
                ],
                "custom_transformation_configuration": [],
                "parsing_configuration": []
              }
            ]
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_knowledge_base.nhs",
            "aws_iam_role.kb_role",
            "aws_iam_role_policy.kb_policy",
            "aws_s3_bucket.kb_source",
            "aws_s3_object.nhs_appointments",
            "aws_s3_object.nhs_patient_flow",
            "aws_s3_object.nhs_services",
            "aws_s3vectors_index.nhs",
            "aws_s3vectors_vector_bucket.nhs",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_flow",
      "name": "booking_flow",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:bedrock:us-east-1:376337229415:flow/6MJTEBZ19S",
            "created_at": "2026-01-05T20:52:48Z",
            "customer_encryption_key_arn": null,
            "definition": [
              {
                "connection": [
                  {
                    "configuration": [
                      {
                        "conditional": [],
                        "data": [
                          {
                            "source_output": "document",
                            "target_input": "agentInputText"
                          }
                        ]
                      }
                    ],
                    "name": "InputToTriage",
                    "source": "FlowInput",
                    "target": "TriageAssessment",
                    "type": "Data"
                  },
                  {
                    "configuration": [
                      {
                        "conditional": [],
                        "data": [
                          {
                            "source_output": "agentResponse",
                            "target_input": "urgencyLevel"
                          }
                        ]
                      }
                    ],
                    "name": "TriageToRouter",
                    "source": "TriageAssessment",
                    "target": "UrgencyRouter",
                    "type": "Data"
                  },
                  {
                    "configuration": [
                      {
                        "conditional": [
                          {
                            "condition": "IsEmergency"
                          }
                        ],
                        "data": []
                      }
                    ],
                    "name": "RouterToEmergency",
                    "source": "UrgencyRouter",
                    "target": "EmergencyOutput",
                    "type": "Conditional"
                  },
                  {
                    "configuration": [
                      {
                        "conditional": [
                          {
                            "condition": "IsUrgent"
                          }
                        ],
                        "data": []
                      }
                    ],
                    "name": "RouterToScheduling",
                    "source": "UrgencyRouter",
                    "target": "ScheduleAppointment",
                    "type": "Conditional"
                  },
                  {
                    "configuration": [
                      {
                        "conditional": [
                          {
                            "condition": "IsRoutine"
                          }
                        ],
                        "data": []
                      }
                    ],
                    "name": "RouterToSchedulingRoutine",
                    "source": "UrgencyRouter",
                    "target": "ScheduleAppointment",
                    "type": "Conditional"
                  },
                  {
                    "configuration": [
                      {
                        "conditional": [],
                        "data": [
                          {
                            "source_output": "agentResponse",
                            "target_input": "document"
                          }
                        ]
                      }
                    ],
                    "name": "SchedulingToOutput",
                    "source": "ScheduleAppointment",
                    "target": "FlowOutput",
                    "type": "Data"
                  }
                ],
                "node": [
                  {
                    "configuration": [
                      {
                        "agent": [],
                        "collector": [],
                        "condition": [],
                        "inline_code": [],
                        "input": [
                          {}
                        ],
                        "iterator": [],
                        "knowledge_base": [],
                        "lambda_function": [],
                        "lex": [],
                        "output": [],
                        "prompt": [],
                        "retrieval": [],
                        "storage": []
                      }
                    ],
                    "input": [],
                    "name": "FlowInput",
                    "output": [
                      {
                        "name": "document",
                        "type": "String"
                      }
                    ],
                    "type": "Input"
                  },
                  {
                    "configuration": [
                      {
                        "agent": [
                          {
                            "agent_alias_arn": "arn:aws:bedrock:us-east-1:376337229415:agent-alias/MR73PAVETH/QDLALURO8K"
                          }
                        ],
                        "collector": [],
                        "condition": [],
                        "inline_code": [],
                        "input": [],
                        "iterator": [],
                        "knowledge_base": [],
                        "lambda_function": [],
                        "lex": [],
                        "output": [],
                        "prompt": [],
                        "retrieval": [],
                        "storage": []
                      }
                    ],
                    "input": [
                      {
                        "category": null,
                        "expression": "$.data",
                        "name": "agentInputText",
                        "type": "String"
                      }
                    ],
                    "name": "TriageAssessment",
                    "output": [
                      {
                        "name": "agentResponse",
                        "type": "String"
                      }
                    ],
                    "type": "Agent"
                  },
                  {
                    "configuration": [
                      {
                        "agent": [],
                        "collector": [],
                        "condition": [
                          {
                            "condition": [
                              {
                                "expression": "emergency",
                                "name": "IsEmergency"
                              },
                              {
                                "expression": "urgent",
                                "name": "IsUrgent"
                              },
                              {
                                "expression": "default",
                                "name": "IsRoutine"
                              }
                            ]
                          }
                        ],
                        "inline_code": [],
                        "input": [],
                        "iterator": [],
                        "knowledge_base": [],
                        "lambda_function": [],
                        "lex": [],
                        "output": [],
                        "prompt": [],
                        "retrieval": [],
                        "storage": []
                      }
                    ],
                    "input": [
                      {
                        "category": null,
                        "expression": "$.data",
                        "name": "urgencyLevel",
                        "type": "String"
                      }
                    ],
                    "name": "UrgencyRouter",
                    "output": [],
                    "type": "Condition"
                  },
                  {
                    "configuration": [
                      {
                        "agent": [],
                        "collector": [],
                        "condition": [],
                        "inline_code": [],
                        "input": [],
                        "iterator": [],
                        "knowledge_base": [],
                        "lambda_function": [],
                        "lex": [],
                        "output": [
                          {}
                        ],
                        "prompt": [],
                        "retrieval": [],
                        "storage": []
                      }
                    ],
                    "input": [
                      {
                        "category": null,
                        "expression": "$.data",
                        "name": "document",
                        "type": "String"
                      }
                    ],
                    "name": "EmergencyOutput",
                    "output": [],
                    "type": "Output"
                  },
                  {
                    "configuration": [
                      {
                        "agent": [
                          {
                            "agent_alias_arn": "arn:aws:bedrock:us-east-1:376337229415:agent-alias/9ESYPRBHBS/IEFOL2DN6G"
                          }
                        ],
                        "collector": [],
                        "condition": [],
                        "inline_code": [],
                        "input": [],
                        "iterator": [],
                        "knowledge_base": [],
                        "lambda_function": [],
                        "lex": [],
                        "output": [],
                        "prompt": [],
                        "retrieval": [],
                        "storage": []
                      }
                    ],
                    "input": [
                      {
                        "category": null,
                        "expression": "$.data",
                        "name": "agentInputText",
                        "type": "String"
                      }
                    ],
                    "name": "ScheduleAppointment",
                    "output": [
                      {
                        "name": "agentResponse",
                        "type": "String"
                      }
                    ],
                    "type": "Agent"
                  },
                  {
                    "configuration": [
                      {
                        "agent": [],
                        "collector": [],
                        "condition": [],
                        "inline_code": [],
                        "input": [],
                        "iterator": [],
                        "knowledge_base": [],
                        "lambda_function": [],
                        "lex": [],
                        "output": [
                          {}
                        ],
                        "prompt": [],
                        "retrieval": [],
                        "storage": []
                      }
                    ],
                    "input": [
                      {
                        "category": null,
                        "expression": "$.data",
                        "name": "document",
                        "type": "String"
                      }
                    ],
                    "name": "FlowOutput",
                    "output": [],
                    "type": "Output"
                  }
                ]
              }
            ],
            "description": "NHS patient booking workflow with triage and scheduling",
            "execution_role_arn": "arn:aws:iam::376337229415:role/nhs-booking-demo-flow-role",
            "id": "6MJTEBZ19S",
            "name": "nhs-booking-demo-booking-flow",
            "region": "us-east-1",
            "status": "NotPrepared",
            "tags": null,
            "tags_all": {},
            "timeouts": null,
            "updated_at": "2026-01-05T20:52:48Z",
            "version": "DRAFT"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.scheduling",
            "aws_bedrockagent_agent.triage",
            "aws_bedrockagent_agent_alias.scheduling_live",
            "aws_bedrockagent_agent_alias.triage_live",
            "aws_iam_role.bedrock_agent",
            "aws_iam_role.flow_role",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_knowledge_base",
      "name": "nhs",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:bedrock:us-east-1:376337229415:knowledge-base/BNGLROUXOJ",
            "created_at": "2026-01-05T19:44:12Z",
            "description": "NHS appointment and services information",
            "failure_reasons": null,
            "id": "BNGLROUXOJ",
            "knowledge_base_configuration": [
              {
                "kendra_knowledge_base_configuration": [],
                "sql_knowledge_base_configuration": [],
                "type": "VECTOR",
                "vector_knowledge_base_configuration": [
                  {
                    "embedding_model_arn": "arn:aws:bedrock:us-east-1::foundation-model/amazon.titan-embed-text-v2:0",
                    "embedding_model_configuration": [
                      {
                        "bedrock_embedding_model_configuration": [
                          {
                            "dimensions": 1024,
                            "embedding_data_type": "FLOAT32"
                          }
                        ]
                      }
                    ],
                    "supplemental_data_storage_configuration": []
                  }
                ]
              }
            ],
            "name": "nhs-booking-demo-kb",
            "region": "us-east-1",
            "role_arn": "arn:aws:iam::376337229415:role/nhs-booking-demo-kb-role",
            "storage_configuration": [
              {
                "mongo_db_atlas_configuration": [],
                "neptune_analytics_configuration": [],
                "opensearch_managed_cluster_configuration": [],
                "opensearch_serverless_configuration": [],
                "pinecone_configuration": [],
                "rds_configuration": [],
                "redis_enterprise_cloud_configuration": [],
                "s3_vectors_configuration": [
                  {
                    "index_arn": "arn:aws:s3vectors:us-east-1:376337229415:bucket/nhs-booking-demo-vectors/index/nhs-booking-demo-index",
                    "index_name": null,
                    "vector_bucket_arn": null
                  }
                ],
                "type": "S3_VECTORS"
              }
            ],
            "tags": null,
            "tags_all": {},
            "timeouts": null,
            "updated_at": "2026-01-05T19:44:12Z"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_iam_role.kb_role",
            "aws_iam_role_policy.kb_policy",
            "aws_s3_bucket.kb_source",
            "aws_s3vectors_index.nhs",
            "aws_s3vectors_vector_bucket.nhs",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_dynamodb_table",
      "name": "bookings",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:dynamodb:us-east-1:376337229415:table/nhs-booking-demo-bookings",
            "attribute": [
              {
                "name": "booking_id",
                "type": "S"
              }
            ],
            "billing_mode": "PAY_PER_REQUEST",
            "deletion_protection_enabled": false,
            "global_secondary_index": [],
            "global_table_witness": [],
            "hash_key": "booking_id",
            "id": "nhs-booking-demo-bookings",
            "import_table": [],
            "local_secondary_index": [],
            "name": "nhs-booking-demo-bookings",
            "on_demand_throughput": [],
            "point_in_time_recovery": [
              {
                "enabled": false,
                "recovery_period_in_days": 0
              }
            ],
            "range_key": null,
            "read_capacity": 0,
            "region": "us-east-1",
            "replica": [],
            "restore_date_time": null,
            "restore_source_name": null,
            "restore_source_table_arn": null,
            "restore_to_latest_time": null,
            "server_side_encryption": [],
            "stream_arn": "",
            "stream_enabled": false,
            "stream_label": "",
            "stream_view_type": "",
            "table_class": "STANDARD",
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "ttl": [
              {
                "attribute_name": "",
                "enabled": false
              }
            ],
            "warm_throughput": [],
            "write_capacity": 0
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjYwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_dynamodb_table",
      "name": "sessions",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:dynamodb:us-east-1:376337229415:table/nhs-booking-demo-sessions",
            "attribute": [
              {
                "name": "session_id",
                "type": "S"
              }
            ],
            "billing_mode": "PAY_PER_REQUEST",
            "deletion_protection_enabled": false,
            "global_secondary_index": [],
            "global_table_witness": [],
            "hash_key": "session_id",
            "id": "nhs-booking-demo-sessions",
            "import_table": [],
            "local_secondary_index": [],
            "name": "nhs-booking-demo-sessions",
            "on_demand_throughput": [],
            "point_in_time_recovery": [
              {
                "enabled": false,
                "recovery_period_in_days": 0
              }
            ],
            "range_key": null,
            "read_capacity": 0,
            "region": "us-east-1",
            "replica": [],
            "restore_date_time": null,
            "restore_source_name": null,
            "restore_source_table_arn": null,
            "restore_to_latest_time": null,
            "server_side_encryption": [],
            "stream_arn": "",
            "stream_enabled": false,
            "stream_label": "",
            "stream_view_type": "",
            "table_class": "STANDARD",
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "ttl": [
              {
                "attribute_name": "ttl",
                "enabled": true
              }
            ],
            "warm_throughput": [],
            "write_capacity": 0
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjYwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "bedrock_agent",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::376337229415:role/nhs-booking-demo-bedrock-agent-role",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Condition\":{\"StringEquals\":{\"aws:SourceAccount\":\"376337229415\"}},\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"bedrock.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2026-01-05T18:30:21Z",
            "description": "",
            "force_detach_policies": false,
            "id": "nhs-booking-demo-bedrock-agent-role",
            "inline_policy": [
              {
                "name": "nhs-booking-demo-agent-collaborator-policy",
                "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"bedrock:InvokeAgent\",\"bedrock:GetAgentAlias\",\"bedrock:GetAgent\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:bedrock:us-east-1:376337229415:agent/*\",\"arn:aws:bedrock:us-east-1:376337229415:agent-alias/*\"]}]}"
              },
              {
                "name": "nhs-booking-demo-bedrock-agent-policy",
                "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"bedrock:InvokeModel\",\"bedrock:InvokeModelWithResponseStream\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:bedrock:us-east-1::foundation-model/*\"},{\"Action\":[\"lambda:InvokeFunction\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:lambda:us-east-1:376337229415:function:nhs-booking-demo-actions\"}]}"
              }
            ],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "nhs-booking-demo-bedrock-agent-role",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {},
            "unique_id": "AROAVPH3SMZT6BJNPKLII"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "name": "nhs-booking-demo-bedrock-agent-role"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "flow_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::376337229415:role/nhs-booking-demo-flow-role",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Condition\":{\"StringEquals\":{\"aws:SourceAccount\":\"376337229415\"}},\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"bedrock.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2026-01-05T20:52:39Z",
            "description": "",
            "force_detach_policies": false,
            "id": "nhs-booking-demo-flow-role",
            "inline_policy": [
              {
                "name": "nhs-booking-demo-flow-policy",
                "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"bedrock:InvokeModel\",\"bedrock:InvokeModelWithResponseStream\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:bedrock:us-east-1::foundation-model/*\"},{\"Action\":[\"bedrock:InvokeAgent\",\"bedrock:GetAgentAlias\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:bedrock:us-east-1:376337229415:agent/*\",\"arn:aws:bedrock:us-east-1:376337229415:agent-alias/*\"]}]}"
              }
            ],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "nhs-booking-demo-flow-role",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {},
            "unique_id": "AROAVPH3SMZTT3OZAZNDV"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "name": "nhs-booking-demo-flow-role"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "kb_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::376337229415:role/nhs-booking-demo-kb-role",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Condition\":{\"StringEquals\":{\"aws:SourceAccount\":\"376337229415\"}},\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"bedrock.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2026-01-05T19:29:38Z",
            "description": "",
            "force_detach_policies": false,
            "id": "nhs-booking-demo-kb-role",
            "inline_policy": [
              {
                "name": "nhs-booking-demo-kb-policy",
                "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"s3:GetObject\",\"s3:ListBucket\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:s3:::nhs-booking-demo-kb-source-376337229415\",\"arn:aws:s3:::nhs-booking-demo-kb-source-376337229415/*\"]},{\"Action\":[\"s3vectors:CreateIndex\",\"s3vectors:DeleteIndex\",\"s3vectors:GetIndex\",\"s3vectors:ListIndexes\",\"s3vectors:PutVectors\",\"s3vectors:GetVectors\",\"s3vectors:DeleteVectors\",\"s3vectors:QueryVectors\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:s3vectors:us-east-1:376337229415:bucket/nhs-booking-demo-vectors\",\"arn:aws:s3vectors:us-east-1:376337229415:bucket/nhs-booking-demo-vectors/*\",\"arn:aws:s3vectors:us-east-1:376337229415:bucket/nhs-booking-demo-vectors/index/nhs-booking-demo-index\"]},{\"Action\":[\"bedrock:InvokeModel\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:bedrock:us-east-1::foundation-model/*\"}]}"
              }
            ],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "nhs-booking-demo-kb-role",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {},
            "unique_id": "AROAVPH3SMZT6LUPTIMW6"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "name": "nhs-booking-demo-kb-role"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "lambda",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::376337229415:role/nhs-booking-demo-lambda-role",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2026-01-05T18:30:21Z",
            "description": "",
            "force_detach_policies": false,
            "id": "nhs-booking-demo-lambda-role",
            "inline_policy": [
              {
                "name": "nhs-booking-demo-lambda-dynamodb",
                "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"dynamodb:GetItem\",\"dynamodb:PutItem\",\"dynamodb:UpdateItem\",\"dynamodb:Query\",\"dynamodb:Scan\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:dynamodb:us-east-1:376337229415:table/nhs-booking-demo-sessions\",\"arn:aws:dynamodb:us-east-1:376337229415:table/nhs-booking-demo-bookings\"]}]}"
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::aws:policy/AWSXRayDaemonWriteAccess",
              "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
            ],
            "max_session_duration": 3600,
            "name": "nhs-booking-demo-lambda-role",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {},
            "unique_id": "AROAVPH3SMZT6LDRJIFIE"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "name": "nhs-booking-demo-lambda-role"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "bedrock_agent",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "nhs-booking-demo-bedrock-agent-role:nhs-booking-demo-bedrock-agent-policy",
            "name": "nhs-booking-demo-bedrock-agent-policy",
            "name_prefix": "",
            "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"bedrock:InvokeModel\",\"bedrock:InvokeModelWithResponseStream\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:bedrock:us-east-1::foundation-model/*\",\"arn:aws:bedrock:us-east-1::foundation-model/*\",\"arn:aws:bedrock:us-west-2::foundation-model/*\"]},{\"Action\":[\"bedrock:InvokeModel\",\"bedrock:InvokeModelWithResponseStream\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:bedrock:*:376337229415:inference-profile/*\"},{\"Action\":[\"bedrock:InvokeTool\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:bedrock:*:*:system-tool/amazon.nova_grounding\"},{\"Action\":[\"lambda:InvokeFunction\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:lambda:us-east-1:376337229415:function:nhs-booking-demo-actions\"}]}",
            "role": "nhs-booking-demo-bedrock-agent-role"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "name": "nhs-booking-demo-bedrock-agent-policy",
            "role": "nhs-booking-demo-bedrock-agent-role"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_dynamodb_table.bookings",
            "aws_dynamodb_table.sessions",
            "aws_iam_role.bedrock_agent",
            "aws_iam_role.lambda",
            "aws_lambda_function.actions",
            "data.archive_file.lambda",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "bedrock_agent_collaborator",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "nhs-booking-demo-bedrock-agent-role:nhs-booking-demo-agent-collaborator-policy",
            "name": "nhs-booking-demo-agent-collaborator-policy",
            "name_prefix": "",
            "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"bedrock:InvokeAgent\",\"bedrock:GetAgentAlias\",\"bedrock:GetAgent\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:bedrock:us-east-1:376337229415:agent/*\",\"arn:aws:bedrock:us-east-1:376337229415:agent-alias/*\"]}]}",
            "role": "nhs-booking-demo-bedrock-agent-role"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "name": "nhs-booking-demo-agent-collaborator-policy",
            "role": "nhs-booking-demo-bedrock-agent-role"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.bedrock_agent",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "flow_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "nhs-booking-demo-flow-role:nhs-booking-demo-flow-policy",
            "name": "nhs-booking-demo-flow-policy",
            "name_prefix": "",
            "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"bedrock:InvokeModel\",\"bedrock:InvokeModelWithResponseStream\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:bedrock:us-east-1::foundation-model/*\"},{\"Action\":[\"bedrock:InvokeAgent\",\"bedrock:GetAgentAlias\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:bedrock:us-east-1:376337229415:agent/*\",\"arn:aws:bedrock:us-east-1:376337229415:agent-alias/*\"]}]}",
            "role": "nhs-booking-demo-flow-role"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "name": "nhs-booking-demo-flow-policy",
            "role": "nhs-booking-demo-flow-role"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.flow_role",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "kb_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "nhs-booking-demo-kb-role:nhs-booking-demo-kb-policy",
            "name": "nhs-booking-demo-kb-policy",
            "name_prefix": "",
            "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"s3:GetObject\",\"s3:ListBucket\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:s3:::nhs-booking-demo-kb-source-376337229415\",\"arn:aws:s3:::nhs-booking-demo-kb-source-376337229415/*\"]},{\"Action\":[\"s3vectors:CreateIndex\",\"s3vectors:DeleteIndex\",\"s3vectors:GetIndex\",\"s3vectors:ListIndexes\",\"s3vectors:PutVectors\",\"s3vectors:GetVectors\",\"s3vectors:DeleteVectors\",\"s3vectors:QueryVectors\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:s3vectors:us-east-1:376337229415:bucket/nhs-booking-demo-vectors\",\"arn:aws:s3vectors:us-east-1:376337229415:bucket/nhs-booking-demo-vectors/*\",\"arn:aws:s3vectors:us-east-1:376337229415:bucket/nhs-booking-demo-vectors/index/nhs-booking-demo-index\"]},{\"Action\":[\"bedrock:InvokeModel\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:bedrock:us-east-1::foundation-model/*\"}]}",
            "role": "nhs-booking-demo-kb-role"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "name": "nhs-booking-demo-kb-policy",
            "role": "nhs-booking-demo-kb-role"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.kb_role",
            "aws_s3_bucket.kb_source",
            "aws_s3vectors_index.nhs",
            "aws_s3vectors_vector_bucket.nhs",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "lambda_dynamodb",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "nhs-booking-demo-lambda-role:nhs-booking-demo-lambda-dynamodb",
            "name": "nhs-booking-demo-lambda-dynamodb",
            "name_prefix": "",
            "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"dynamodb:GetItem\",\"dynamodb:PutItem\",\"dynamodb:UpdateItem\",\"dynamodb:Query\",\"dynamodb:Scan\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:dynamodb:us-east-1:376337229415:table/nhs-booking-demo-sessions\",\"arn:aws:dynamodb:us-east-1:376337229415:table/nhs-booking-demo-bookings\"]}]}",
            "role": "nhs-booking-demo-lambda-role"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "name": "nhs-booking-demo-lambda-dynamodb",
            "role": "nhs-booking-demo-lambda-role"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_dynamodb_table.bookings",
            "aws_dynamodb_table.sessions",
            "aws_iam_role.lambda"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "lambda_location",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "nhs-booking-demo-lambda-role:nhs-booking-demo-lambda-location",
            "name": "nhs-booking-demo-lambda-location",
            "name_prefix": "",
            "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"geo:SearchPlaceIndexForText\",\"geo:SearchPlaceIndexForPosition\",\"geo-places:Geocode\",\"geo-places:SearchNearby\",\"geo-places:SearchText\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}]}",
            "role": "nhs-booking-demo-lambda-role"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "name": "nhs-booking-demo-lambda-location",
            "role": "nhs-booking-demo-lambda-role"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.lambda"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "lambda_basic",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "nhs-booking-demo-lambda-role/arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "role": "nhs-booking-demo-lambda-role"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
            "role": "nhs-booking-demo-lambda-role"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.lambda"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "lambda_xray",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "nhs-booking-demo-lambda-role/arn:aws:iam::aws:policy/AWSXRayDaemonWriteAccess",
            "policy_arn": "arn:aws:iam::aws:policy/AWSXRayDaemonWriteAccess",
            "role": "nhs-booking-demo-lambda-role"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "policy_arn": "arn:aws:iam::aws:policy/AWSXRayDaemonWriteAccess",
            "role": "nhs-booking-demo-lambda-role"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.lambda"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_alias",
      "name": "actions_live",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:lambda:us-east-1:376337229415:function:nhs-booking-demo-actions:live",
            "description": "",
            "function_name": "nhs-booking-demo-actions",
            "function_version": "$LATEST",
            "id": "arn:aws:lambda:us-east-1:376337229415:function:nhs-booking-demo-actions:live",
            "invoke_arn": "arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:376337229415:function:nhs-booking-demo-actions:live/invocations",
            "name": "live",
            "region": "us-east-1",
            "routing_config": []
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_dynamodb_table.bookings",
            "aws_dynamodb_table.sessions",
            "aws_iam_role.lambda",
            "aws_lambda_function.actions",
            "data.archive_file.lambda"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "actions",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "architectures": [
              "x86_64"
            ],
            "arn": "arn:aws:lambda:us-east-1:376337229415:function:nhs-booking-demo-actions",
            "capacity_provider_config": [],
            "code_sha256": "SZKXcezEPm4VUUHja2L+rRhNoQkJWPCTnQ+B8fOUWhk=",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "durable_config": [],
            "environment": [
              {
                "variables": {
                  "BOOKINGS_TABLE": "nhs-booking-demo-bookings",
                  "SESSIONS_TABLE": "nhs-booking-demo-sessions"
                }
              }
            ],
            "ephemeral_storage": [
              {
                "size": 512
              }
            ],
            "file_system_config": [],
            "filename": "./.terraform/lambda.zip",
            "function_name": "nhs-booking-demo-actions",
            "handler": "lambda_actions.handler",
            "id": "nhs-booking-demo-actions",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:376337229415:function:nhs-booking-demo-actions/invocations",
            "kms_key_arn": "",
            "last_modified": "2026-01-05T22:18:06.000+0000",
            "layers": [],
            "logging_config": [
              {
                "application_log_level": "",
                "log_format": "Text",
                "log_group": "/aws/lambda/nhs-booking-demo-actions",
                "system_log_level": ""
              }
            ],
            "memory_size": 256,
            "package_type": "Zip",
            "publish": false,
            "publish_to": null,
            "qualified_arn": "arn:aws:lambda:us-east-1:376337229415:function:nhs-booking-demo-actions:$LATEST",
            "qualified_invoke_arn": "arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:376337229415:function:nhs-booking-demo-actions:$LATEST/invocations",
            "region": "us-east-1",
            "replace_security_groups_on_destroy": null,
            "replacement_security_group_ids": null,
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::376337229415:role/nhs-booking-demo-lambda-role",
            "runtime": "python3.11",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "skip_destroy": false,
            "snap_start": [],
            "source_code_hash": "SZKXcezEPm4VUUHja2L+rRhNoQkJWPCTnQ+B8fOUWhk=",
            "source_code_size": 4091,
            "source_kms_key_arn": "",
            "tags": {},
            "tags_all": {},
            "tenancy_config": [],
            "timeout": 30,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "Active"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "function_name": "nhs-booking-demo-actions",
            "region": "us-east-1"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH19",
          "dependencies": [
            "aws_dynamodb_table.bookings",
            "aws_dynamodb_table.sessions",
            "aws_iam_role.lambda",
            "data.archive_file.lambda"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_lambda_permission",
      "name": "bedrock",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "action": "lambda:InvokeFunction",
            "event_source_token": null,
            "function_name": "nhs-booking-demo-actions",
            "function_url_auth_type": null,
            "id": "AllowBedrock",
            "principal": "bedrock.amazonaws.com",
            "principal_org_id": null,
            "qualifier": "",
            "region": "us-east-1",
            "source_account": null,
            "source_arn": "arn:aws:bedrock:us-east-1:376337229415:agent/*",
            "statement_id": "AllowBedrock",
            "statement_id_prefix": ""
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "function_name": "nhs-booking-demo-actions",
            "qualifier": null,
            "region": "us-east-1",
            "statement_id": "AllowBedrock"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_dynamodb_table.bookings",
            "aws_dynamodb_table.sessions",
            "aws_iam_role.lambda",
            "aws_lambda_function.actions",
            "data.archive_file.lambda",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "demo",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": null,
            "arn": "arn:aws:s3:::nhs-booking-demo-demo-376337229415",
            "bucket": "nhs-booking-demo-demo-376337229415",
            "bucket_domain_name": "nhs-booking-demo-demo-376337229415.s3.amazonaws.com",
            "bucket_prefix": "",
            "bucket_region": "us-east-1",
            "bucket_regional_domain_name": "nhs-booking-demo-demo-376337229415.s3.us-east-1.amazonaws.com",
            "cors_rule": [],
            "force_destroy": true,
            "grant": [
              {
                "id": "b6952ffb0bf54ead31d3b58cd8be7a56ccf9807862a1d0f01bcc592385dc4b4c",
                "permissions": [
                  "FULL_CONTROL"
                ],
                "type": "CanonicalUser",
                "uri": ""
              }
            ],
            "hosted_zone_id": "Z3AQBSTGFYJSTF",
            "id": "nhs-booking-demo-demo-376337229415",
            "lifecycle_rule": [],
            "logging": [],
            "object_lock_configuration": [],
            "object_lock_enabled": false,
            "policy": "",
            "region": "us-east-1",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "",
                        "sse_algorithm": "AES256"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "versioning": [
              {
                "enabled": false,
                "mfa_delete": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "bucket": "nhs-booking-demo-demo-376337229415",
            "region": "us-east-1"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "kb_source",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": null,
            "arn": "arn:aws:s3:::nhs-booking-demo-kb-source-376337229415",
            "bucket": "nhs-booking-demo-kb-source-376337229415",
            "bucket_domain_name": "nhs-booking-demo-kb-source-376337229415.s3.amazonaws.com",
            "bucket_prefix": "",
            "bucket_region": "us-east-1",
            "bucket_regional_domain_name": "nhs-booking-demo-kb-source-376337229415.s3.us-east-1.amazonaws.com",
            "cors_rule": [],
            "force_destroy": true,
            "grant": [
              {
                "id": "b6952ffb0bf54ead31d3b58cd8be7a56ccf9807862a1d0f01bcc592385dc4b4c",
                "permissions": [
                  "FULL_CONTROL"
                ],
                "type": "CanonicalUser",
                "uri": ""
              }
            ],
            "hosted_zone_id": "Z3AQBSTGFYJSTF",
            "id": "nhs-booking-demo-kb-source-376337229415",
            "lifecycle_rule": [],
            "logging": [],
            "object_lock_configuration": [],
            "object_lock_enabled": false,
            "policy": "",
            "region": "us-east-1",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "",
                        "sse_algorithm": "AES256"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {},
            "tags_all": {},
            "timeouts": null,
            "versioning": [
              {
                "enabled": false,
                "mfa_delete": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "bucket": "nhs-booking-demo-kb-source-376337229415",
            "region": "us-east-1"
          },
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_object",
      "name": "nhs_appointments",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acl": null,
            "arn": "arn:aws:s3:::nhs-booking-demo-kb-source-376337229415/nhs_content/appointments.md",
            "bucket": "nhs-booking-demo-kb-source-376337229415",
            "bucket_key_enabled": false,
            "cache_control": "",
            "checksum_algorithm": null,
            "checksum_crc32": "",
            "checksum_crc32c": "",
            "checksum_crc64nvme": "",
            "checksum_sha1": "",
            "checksum_sha256": "",
            "content": "# NHS Appointment Types\n\n## GP Appointments\n- Routine appointments: Usually available within 1-2 weeks\n- Urgent appointments: Same day or next day for urgent issues\n- Telephone consultations: Quick advice without visiting surgery\n\n## Specialist Referrals\n- Referrals made by your GP\n- Waiting times vary by specialty\n- Two-week wait for suspected cancer\n\n## What to Bring\n- NHS number if known\n- List of current medications\n- Any relevant test results\n\n## Cancellation Policy\n- Please cancel at least 24 hours in advance\n- Missed appointments waste NHS resources\n",
            "content_base64": null,
            "content_disposition": "",
            "content_encoding": "",
            "content_language": "",
            "content_type": "application/octet-stream",
            "etag": "5d1991b7844105a54b77bf279ecbf17c",
            "force_destroy": false,
            "id": "nhs-booking-demo-kb-source-376337229415/nhs_content/appointments.md",
            "key": "nhs_content/appointments.md",
            "kms_key_id": null,
            "metadata": {},
            "object_lock_legal_hold_status": "",
            "object_lock_mode": "",
            "object_lock_retain_until_date": "",
            "override_provider": [],
            "region": "us-east-1",
            "server_side_encryption": "AES256",
            "source": null,
            "source_hash": null,
            "storage_class": "STANDARD",
            "tags": {},
            "tags_all": {},
            "version_id": "",
            "website_redirect": ""
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "bucket": "nhs-booking-demo-kb-source-376337229415",
            "key": "nhs_content/appointments.md",
            "region": "us-east-1"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.kb_source",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_object",
      "name": "nhs_patient_flow",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acl": null,
            "arn": "arn:aws:s3:::nhs-booking-demo-kb-source-376337229415/nhs_content/patient_flow.md",
            "bucket": "nhs-booking-demo-kb-source-376337229415",
            "bucket_key_enabled": false,
            "cache_control": "",
            "checksum_algorithm": null,
            "checksum_crc32": "",
            "checksum_crc32c": "",
            "checksum_crc64nvme": "",
            "checksum_sha1": "",
            "checksum_sha256": "",
            "content": "# Patient Flow and Booking Process\n\n## Booking an Appointment\n1. Contact your GP surgery by phone or online\n2. Describe your symptoms to the receptionist\n3. You may be offered telephone triage first\n4. Appointment booked based on clinical need\n\n## On the Day\n1. Arrive 10 minutes before your appointment\n2. Check in at reception or self-service kiosk\n3. Wait to be called by your clinician\n4. Consultation typically lasts 10-15 minutes\n\n## After Your Appointment\n- Collect any prescriptions from pharmacy\n- Book follow-up appointments if needed\n- Access your records via NHS App\n\n## Improving Patient Flow\n- Book appropriate appointment type\n- Cancel if you can't attend\n- Use NHS 111 for advice before booking\n",
            "content_base64": null,
            "content_disposition": "",
            "content_encoding": "",
            "content_language": "",
            "content_type": "application/octet-stream",
            "etag": "b5497d0992140af0a8cc7537a1df06fa",
            "force_destroy": false,
            "id": "nhs-booking-demo-kb-source-376337229415/nhs_content/patient_flow.md",
            "key": "nhs_content/patient_flow.md",
            "kms_key_id": null,
            "metadata": {},
            "object_lock_legal_hold_status": "",
            "object_lock_mode": "",
            "object_lock_retain_until_date": "",
            "override_provider": [],
            "region": "us-east-1",
            "server_side_encryption": "AES256",
            "source": null,
            "source_hash": null,
            "storage_class": "STANDARD",
            "tags": {},
            "tags_all": {},
            "version_id": "",
            "website_redirect": ""
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "bucket": "nhs-booking-demo-kb-source-376337229415",
            "key": "nhs_content/patient_flow.md",
            "region": "us-east-1"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.kb_source",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3_object",
      "name": "nhs_services",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acl": null,
            "arn": "arn:aws:s3:::nhs-booking-demo-kb-source-376337229415/nhs_content/services.md",
            "bucket": "nhs-booking-demo-kb-source-376337229415",
            "bucket_key_enabled": false,
            "cache_control": "",
            "checksum_algorithm": null,
            "checksum_crc32": "",
            "checksum_crc32c": "",
            "checksum_crc64nvme": "",
            "checksum_sha1": "",
            "checksum_sha256": "",
            "content": "# NHS Services Overview\n\n## Primary Care\n- GP surgeries for general health concerns\n- Walk-in centres for minor illnesses\n- NHS 111 for urgent medical advice\n\n## Emergency Services\n- A\u0026E for life-threatening emergencies\n- Call 999 for immediate danger\n- Minor injuries units for non-life-threatening injuries\n\n## Mental Health\n- IAPT services for anxiety and depression\n- Crisis teams for urgent mental health support\n- Community mental health teams\n\n## Pharmacy Services\n- Minor ailment consultations\n- Prescription collection\n- Health advice\n",
            "content_base64": null,
            "content_disposition": "",
            "content_encoding": "",
            "content_language": "",
            "content_type": "application/octet-stream",
            "etag": "0167705e24b38fc0b773db4d140c319d",
            "force_destroy": false,
            "id": "nhs-booking-demo-kb-source-376337229415/nhs_content/services.md",
            "key": "nhs_content/services.md",
            "kms_key_id": null,
            "metadata": {},
            "object_lock_legal_hold_status": "",
            "object_lock_mode": "",
            "object_lock_retain_until_date": "",
            "override_provider": [],
            "region": "us-east-1",
            "server_side_encryption": "AES256",
            "source": null,
            "source_hash": null,
            "storage_class": "STANDARD",
            "tags": {},
            "tags_all": {},
            "version_id": "",
            "website_redirect": ""
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "376337229415",
            "bucket": "nhs-booking-demo-kb-source-376337229415",
            "key": "nhs_content/services.md",
            "region": "us-east-1"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_s3_bucket.kb_source",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3vectors_index",
      "name": "nhs",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "creation_time": "2026-01-05T19:44:00Z",
            "data_type": "float32",
            "dimension": 1024,
            "distance_metric": "cosine",
            "encryption_configuration": [
              {
                "kms_key_arn": null,
                "sse_type": "AES256"
              }
            ],
            "index_arn": "arn:aws:s3vectors:us-east-1:376337229415:bucket/nhs-booking-demo-vectors/index/nhs-booking-demo-index",
            "index_name": "nhs-booking-demo-index",
            "metadata_configuration": [],
            "region": "us-east-1",
            "tags": null,
            "tags_all": {},
            "vector_bucket_name": "nhs-booking-demo-vectors"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "index_arn": "arn:aws:s3vectors:us-east-1:376337229415:bucket/nhs-booking-demo-vectors/index/nhs-booking-demo-index"
          },
          "dependencies": [
            "aws_s3vectors_vector_bucket.nhs"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_s3vectors_vector_bucket",
      "name": "nhs",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "creation_time": "2026-01-05T19:44:00Z",
            "encryption_configuration": [
              {
                "kms_key_arn": null,
                "sse_type": "AES256"
              }
            ],
            "force_destroy": true,
            "region": "us-east-1",
            "tags": null,
            "tags_all": {},
            "vector_bucket_arn": "arn:aws:s3vectors:us-east-1:376337229415:bucket/nhs-booking-demo-vectors",
            "vector_bucket_name": "nhs-booking-demo-vectors"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "vector_bucket_arn": "arn:aws:s3vectors:us-east-1:376337229415:bucket/nhs-booking-demo-vectors"
          }
        }
      ]
    },
    {
      "mode": "managed",
      "type": "null_resource",
      "name": "prepare_agent",
      "provider": "provider[\"registry.terraform.io/hashicorp/null\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "1619331246888842739",
            "triggers": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.supervisor",
            "aws_bedrockagent_agent_action_group.booking",
            "aws_dynamodb_table.bookings",
            "aws_dynamodb_table.sessions",
            "aws_iam_role.bedrock_agent",
            "aws_iam_role.lambda",
            "aws_lambda_function.actions",
            "data.archive_file.lambda",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "null_resource",
      "name": "prepare_supervisor",
      "provider": "provider[\"registry.terraform.io/hashicorp/null\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "2088213472136281094",
            "triggers": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.information",
            "aws_bedrockagent_agent.scheduling",
            "aws_bedrockagent_agent.supervisor_multi",
            "aws_bedrockagent_agent.triage",
            "aws_bedrockagent_agent_alias.information_live",
            "aws_bedrockagent_agent_alias.scheduling_live",
            "aws_bedrockagent_agent_alias.triage_live",
            "aws_bedrockagent_agent_collaborator.information",
            "aws_bedrockagent_agent_collaborator.scheduling",
            "aws_bedrockagent_agent_collaborator.triage",
            "aws_iam_role.bedrock_agent",
            "aws_iam_role_policy.bedrock_agent_collaborator",
            "data.aws_caller_identity.current"
          ]
        }
      ]
    }
  ],
  "check_results": null
}
